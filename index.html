<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Kasir Jasuke.id</title>

<style>
body{font-family:Arial;background:#f6f6f6;margin:0}
.container{max-width:420px;margin:auto;background:#fff;min-height:100vh;padding:12px}
h1{text-align:center;font-size:22px;margin:10px 0}
h2{margin-top:20px;font-size:18px}

/* TOTAL */
.total-box{
  background:#4CAF50;color:white;text-align:center;
  padding:12px;border-radius:14px;
  font-size:18px;font-weight:bold;
}

/* GRID */
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:10px}

/* TOMBOL UMUM */
.item-btn{
  padding:18px 10px;
  border-radius:14px;
  font-size:14px;
  font-weight:bold;
  border:2px solid #ccc;
  background:#fff;
}
.item-btn:active{opacity:.85}

/* WARNA CUP */
.keju{background:#FFF3B0;border-color:#E6C200}
.coklat{background:#E8C1A0;border-color:#B87333}
.mix{
  background:linear-gradient(to bottom,#FFF3B0 50%,#E8C1A0 50%);
  border-color:#C9A24D;
}
.all{
  background:linear-gradient(90deg,#FFD6D6,#FFF3B0,#D6F5D6,#D6E4FF,#F0D6FF);
  border-color:#C5C5C5;
}

/* OPSI UANG PEMBELI */
.bayar-btn{
  background:#E0E0E0;
  color:#000;
  border:2px solid #BDBDBD;
}
.bayar-btn.active-bayar{
  background:#4CAF50;
  color:#fff;
  border-color:#388E3C;
}

/* ACTION */
.action-bar{display:flex;gap:10px;margin-top:15px}
.action-bar button{
  flex:1;background:#eee;border:1px solid #ccc;
  padding:12px;border-radius:12px;font-weight:bold;
}

/* KERANJANG */
.cart-list{
  background:#f1f1f1;border-radius:12px;
  padding:10px;font-size:14px;
}
.cart-item{
  display:flex;justify-content:space-between;
  border-bottom:1px dashed #ccc;padding:4px 0;
}

.undo-btn{
  margin-top:8px;width:100%;
  background:#f9f9f9;border:1px dashed #999;
  padding:10px;border-radius:10px;font-weight:bold;
}

/* TABEL */
table{width:100%;border-collapse:collapse;margin-top:20px;font-size:12px}
th,td{border:1px solid #ddd;padding:6px;text-align:center}
th{background:#eee}

/* AKSI */
.aksi-btn{
  font-size:11px;padding:4px 6px;margin:2px;
  border-radius:6px;border:1px solid #ccc;
  cursor:pointer;
}
.hapus{color:red}

/* EXPORT */
.export-btn{
  margin-top:10px;
  width:100%;
  background:#2196F3;
  color:white;
  border:none;
  padding:12px;
  border-radius:12px;
  font-weight:bold;
}
</style>
</head>

<body>
<div class="container">

<h1>Kasir Jasuke.id</h1>
<div id="totalBox" class="total-box">Total Masuk: Rp0</div>

<h2>Cup Kecil</h2>
<div class="grid">
<button class="item-btn keju" onclick="tambahItem('Jasuke Full Keju','k',5000)">Keju 5k</button>
<button class="item-btn coklat" onclick="tambahItem('Jasuco Full Coklat','k',5000)">Coklat 5k</button>
<button class="item-btn mix" onclick="tambahItem('Mix Coklat Keju','k',7000)">Mix 7k</button>
<button class="item-btn all" onclick="tambahItem('All Varian','k',8000)">All 8k</button>
</div>

<h2>Cup Sedang</h2>
<div class="grid">
<button class="item-btn keju" onclick="tambahItem('Jasuke Full Keju','b',10000)">Keju 10k</button>
<button class="item-btn coklat" onclick="tambahItem('Jasuco Full Coklat','b',10000)">Coklat 10k</button>
<button class="item-btn mix" onclick="tambahItem('Mix Coklat Keju','b',12000)">Mix 12k</button>
<button class="item-btn all" onclick="tambahItem('All Varian','b',12000)">All 12k</button>
</div>

<h2>Cup Super Besar</h2>
<div class="grid">
<button class="item-btn keju" onclick="tambahItem('Jasuke Full Keju','s',15000)">Keju 15k</button>
<button class="item-btn coklat" onclick="tambahItem('Jasuco Full Coklat','s',15000)">Coklat 15k</button>
<button class="item-btn mix" onclick="tambahItem('Mix Coklat Keju','s',17000)">Mix 17k</button>
<button class="item-btn all" onclick="tambahItem('All Varian','s',17000)">All 17k</button>
</div>

<h2>Keranjang Pembeli</h2>
<div class="cart-list" id="cartList">Belum ada pesanan</div>
<button class="undo-btn" onclick="undoKeranjang()">‚Ü©Ô∏è Undo Pesanan Terakhir</button>

<div id="cartTotal" class="total-box" style="background:#2196F3;margin-top:10px">Total: Rp0</div>

<div class="grid">
<button class="item-btn bayar-btn" onclick="setBayar(0,this)">Uang Pas</button>
<button class="item-btn bayar-btn" onclick="setBayar(10000,this)">Rp10.000</button>
<button class="item-btn bayar-btn" onclick="setBayar(20000,this)">Rp20.000</button>
<button class="item-btn bayar-btn" onclick="setBayar(50000,this)">Rp50.000</button>
<button class="item-btn bayar-btn" onclick="setBayar(100000,this)">Rp100.000</button>
<button class="item-btn bayar-btn" onclick="setBayarLain(this)">Lainnya</button>
</div>

<div class="action-bar">
<button onclick="clearAll()">Clear All</button>
<button onclick="simpanTransaksi()">Simpan</button>
</div>

<table>
<thead>
<tr>
<th>No</th><th>Pesanan</th><th>Total</th><th>Bayar</th><th>Kembali</th><th>Aksi</th>
</tr>
</thead>
<tbody id="data"></tbody>
</table>

<button class="export-btn" onclick="exportCSV()">üíæ Export Riwayat (CSV)</button>

</div>

<script>
let transaksi = JSON.parse(localStorage.getItem('kasirJagung')) || [];
let keranjang = [];
let historyKeranjang = [];
let uangPembeli = 0;

function resetBayar(){
  document.querySelectorAll('.bayar-btn').forEach(b=>b.classList.remove('active-bayar'));
}

function simpanHistory(){historyKeranjang.push(JSON.stringify(keranjang));}

function tambahItem(nama,ukuran,harga){
  simpanHistory();
  keranjang.push({nama:`${nama}(${ukuran})`,harga});
  renderKeranjang();
}

function undoKeranjang(){
  historyKeranjang.length
  ? keranjang=JSON.parse(historyKeranjang.pop())
  : alert('Tidak ada yang bisa di-undo');
  renderKeranjang();
}

function renderKeranjang(){
  cartList.innerHTML=keranjang.length
  ? keranjang.map(i=>`<div class="cart-item"><span>${i.nama}</span><span>Rp${i.harga}</span></div>`).join('')
  : 'Belum ada pesanan';
  cartTotal.innerText='Total: Rp'+keranjang.reduce((a,b)=>a+b.harga,0);
}

function setBayar(u,el){
  resetBayar();
  el.classList.add('active-bayar');
  uangPembeli=u===0?keranjang.reduce((a,b)=>a+b.harga,0):u;
}

function setBayarLain(el){
  const u=parseInt(prompt('Masukkan uang pembeli'));
  if(!isNaN(u)&&u>0){
    resetBayar();
    el.classList.add('active-bayar');
    uangPembeli=u;
  }
}

function simpanTransaksi(){
  if(!keranjang.length)return alert('Keranjang kosong');
  const t=keranjang.reduce((a,b)=>a+b.harga,0);
  if(uangPembeli<t)return alert('Uang pembeli kurang');
  transaksi.push({
    menu:keranjang.map(i=>i.nama).join(', '),
    total:t,bayar:uangPembeli,kembali:uangPembeli-t
  });
  keranjang=[];uangPembeli=0;historyKeranjang=[];
  resetBayar();
  localStorage.setItem('kasirJagung',JSON.stringify(transaksi));
  renderKeranjang();render();
}

function render(){
  data.innerHTML='';let totalMasuk=0;
  transaksi.forEach((t,i)=>{
    totalMasuk+=t.total;
    data.innerHTML+=`
    <tr>
      <td>${i+1}</td>
      <td>${t.menu}</td>
      <td>Rp${t.total}</td>
      <td>Rp${t.bayar}</td>
      <td>Rp${t.kembali}</td>
      <td>${i===transaksi.length-1
        ?'<button class="aksi-btn" onclick="editTerakhir()">‚úèÔ∏è</button><button class="aksi-btn hapus" onclick="hapusTerakhir()">üóëÔ∏è</button>'
        :'-'}
      </td>
    </tr>`;
  });
  totalBox.innerText='Total Masuk: Rp'+totalMasuk;
}

function exportCSV(){
  if(!transaksi.length)return alert('Tidak ada data');
  let csv='No,Pesanan,Total,Bayar,Kembali\n';
  transaksi.forEach((t,i)=>{
    csv+=`${i+1},"${t.menu}",${t.total},${t.bayar},${t.kembali}\n`;
  });
  const blob=new Blob([csv],{type:'text/csv'});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(blob);
  a.download='riwayat_kasir.csv';
  a.click();
}

function editTerakhir(){
  const t=transaksi.at(-1);
  const b=parseInt(prompt('Edit uang bayar',t.bayar));
  if(!isNaN(b)&&b>=t.total){
    t.bayar=b;t.kembali=b-t.total;
    localStorage.setItem('kasirJagung',JSON.stringify(transaksi));
    render();
  }
}
function hapusTerakhir(){
  if(confirm('Hapus transaksi terakhir?')){
    transaksi.pop();
    localStorage.setItem('kasirJagung',JSON.stringify(transaksi));
    render();
  }
}
function clearAll(){
  if(confirm('Hapus semua transaksi?')){
    transaksi=[];
    localStorage.removeItem('kasirJagung');
    render();
  }
}
render();
</script>

</body>
</html>
