<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Kasir Jasuke.id</title>

<style>
body{font-family:Arial;background:#f6f6f6;margin:0}
.container{max-width:420px;margin:auto;background:#fff;min-height:100vh;padding:12px}
h1{text-align:center;font-size:22px;margin:10px 0}
h2{margin-top:20px;font-size:18px}

.total-box{
  background:#4CAF50;color:white;text-align:center;
  padding:12px;border-radius:14px;
  font-size:18px;font-weight:bold;
}

.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:10px}

.item-btn{
  padding:18px 10px;background:#fff;
  border:2px solid #4CAF50;border-radius:14px;
  font-size:14px;font-weight:bold;
}
.item-btn:active{background:#4CAF50;color:white}

.action-bar{display:flex;gap:10px;margin-top:15px}
.action-bar button{
  flex:1;
  background:#eee;
  border:1px solid #ccc;
  padding:12px;
  border-radius:12px;
  font-weight:bold;
}

.cart-list{
  background:#f1f1f1;
  border-radius:12px;
  padding:10px;
  font-size:14px;
}
.cart-item{
  display:flex;
  justify-content:space-between;
  border-bottom:1px dashed #ccc;
  padding:4px 0;
}

.undo-btn{
  margin-top:8px;
  width:100%;
  background:#f9f9f9;
  border:1px dashed #999;
  padding:10px;
  border-radius:10px;
  font-weight:bold;
}

table{width:100%;border-collapse:collapse;margin-top:20px;font-size:12px}
th,td{border:1px solid #ddd;padding:6px;text-align:center}
th{background:#eee}
</style>
</head>

<body>
<div class="container">

<h1>Kasir Jasuke.id</h1>

<div id="totalBox" class="total-box">Total Masuk: Rp0</div>

<h2>Cup Kecil</h2>
<div class="grid">
<button class="item-btn" onclick="tambahItem('Jasuke Full Keju',5000)">Keju 5k</button>
<button class="item-btn" onclick="tambahItem('Jasuco Full Coklat',5000)">Coklat 5k</button>
<button class="item-btn" onclick="tambahItem('Mix Coklat Keju',7000)">Mix 7k</button>
<button class="item-btn" onclick="tambahItem('All Varian',8000)">All 8k</button>
</div>

<h2>Cup Sedang</h2>
<div class="grid">
<button class="item-btn" onclick="tambahItem('Jasuke Full Keju',10000)">Keju 10k</button>
<button class="item-btn" onclick="tambahItem('Jasuco Full Coklat',10000)">Coklat 10k</button>
<button class="item-btn" onclick="tambahItem('Mix Coklat Keju',12000)">Mix 12k</button>
<button class="item-btn" onclick="tambahItem('All Varian',12000)">All 12k</button>
</div>

<h2>Cup Super Besar</h2>
<div class="grid">
<button class="item-btn" onclick="tambahItem('Jasuke Full Keju',15000)">Keju 15k</button>
<button class="item-btn" onclick="tambahItem('Jasuco Full Coklat',15000)">Coklat 15k</button>
<button class="item-btn" onclick="tambahItem('Mix Coklat Keju',17000)">Mix 17k</button>
<button class="item-btn" onclick="tambahItem('All Varian',17000)">All 17k</button>
</div>

<h2>Keranjang Pembeli</h2>
<div class="cart-list" id="cartList">Belum ada pesanan</div>

<button class="undo-btn" onclick="undoKeranjang()">↩️ Undo Pesanan Terakhir</button>

<div id="cartTotal" class="total-box" style="background:#2196F3;margin-top:10px">Total: Rp0</div>

<!-- OPSI UANG PEMBELI -->
<div class="grid">
<button class="item-btn" onclick="setBayar(0)">Uang Pas</button>
<button class="item-btn" onclick="setBayar(10000)">Rp10.000</button>
<button class="item-btn" onclick="setBayar(20000)">Rp20.000</button>
<button class="item-btn" onclick="setBayar(50000)">Rp50.000</button>
<button class="item-btn" onclick="setBayar(100000)">Rp100.000</button>
<button class="item-btn" onclick="setBayarLain()">Lainnya</button>
</div>

<div class="action-bar">
<button onclick="clearAll()">Clear All</button>
<button onclick="simpanTransaksi()">Simpan</button>
</div>

<table>
<thead>
<tr>
<th>No</th>
<th>Pesanan</th>
<th>Total</th>
<th>Bayar</th>
<th>Kembali</th>
</tr>
</thead>
<tbody id="data"></tbody>
</table>

</div>

<script>
let transaksi = JSON.parse(localStorage.getItem('kasirJagung')) || [];
let keranjang = [];
let historyKeranjang = [];
let uangPembeli = 0;

function simpanHistory(){
  historyKeranjang.push(JSON.stringify(keranjang));
}

function tambahItem(nama,harga){
  simpanHistory();
  keranjang.push({nama,harga});
  renderKeranjang();
}

function undoKeranjang(){
  if(historyKeranjang.length){
    keranjang = JSON.parse(historyKeranjang.pop());
    renderKeranjang();
  }else{
    alert('Tidak ada yang bisa di-undo');
  }
}

function renderKeranjang(){
  const list = document.getElementById('cartList');
  if(keranjang.length===0){
    list.innerHTML='Belum ada pesanan';
  }else{
    list.innerHTML = keranjang.map(i =>
      `<div class="cart-item">
        <span>${i.nama}</span>
        <span>Rp${i.harga}</span>
      </div>`
    ).join('');
  }
  const total = keranjang.reduce((a,b)=>a+b.harga,0);
  document.getElementById('cartTotal').innerText='Total: Rp'+total;
}

function setBayar(uang){
  const total = keranjang.reduce((a,b)=>a+b.harga,0);
  uangPembeli = uang===0 ? total : uang;
}

function setBayarLain(){
  const input = prompt('Masukkan uang pembeli (angka saja)');
  const uang = parseInt(input);
  if(!isNaN(uang) && uang > 0){
    uangPembeli = uang;
  }else{
    alert('Nominal tidak valid');
  }
}

function simpanTransaksi(){
  if(!keranjang.length) return alert('Keranjang kosong');

  const total = keranjang.reduce((a,b)=>a+b.harga,0);

  if(uangPembeli < total){
    alert('Uang pembeli kurang');
    return;
  }

  transaksi.push({
    menu: keranjang.map(i=>i.nama).join(', '),
    total,
    bayar: uangPembeli,
    kembali: uangPembeli-total
  });

  keranjang=[]; uangPembeli=0; historyKeranjang=[];
  localStorage.setItem('kasirJagung',JSON.stringify(transaksi));
  renderKeranjang(); render();
}

function render(){
  let tbody=document.getElementById('data');
  tbody.innerHTML='';
  let totalMasuk=0;

  transaksi.forEach((t,i)=>{
    totalMasuk+=t.total;
    tbody.innerHTML+=`
    <tr>
      <td>${i+1}</td>
      <td>${t.menu}</td>
      <td>Rp${t.total}</td>
      <td>Rp${t.bayar}</td>
      <td>Rp${t.kembali}</td>
    </tr>`;
  });

  document.getElementById('totalBox').innerText='Total Masuk: Rp'+totalMasuk;
}

function clearAll(){
  if(confirm('Hapus semua transaksi?')){
    transaksi=[];
    localStorage.removeItem('kasirJagung');
    render();
  }
}

render();
</script>
</body>
</html>
